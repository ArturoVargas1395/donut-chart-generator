<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Completion Ratio Chart Generator</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
    <div class="container">
        <h1>Completion Ratio Chart Generator</h1>

        <div class="chart-container">
            <!-- Chart Type Selector -->
            <div style="text-align: center; margin-bottom: 20px;">
                <label for="chart_type_selector" style="font-weight: 600; margin-right: 10px;">Chart Type:</label>
                <select id="chart_type_selector" style="
                    padding: 8px 16px;
                    font-size: 16px;
                    border-radius: 6px;
                    border: 2px solid #667eea;
                    background: white;
                    cursor: pointer;
                ">
                    <option value="donut" {{ 'selected' if data.chart_type=='donut' else '' }}>Donut Chart</option>
                    <option value="battery" {{ 'selected' if data.chart_type=='battery' else '' }}>Battery Chart
                    </option>
                </select>
            </div>

            <!-- Donut Chart -->
            <div id="donut-container" class="chart-display"
                style="{{ 'display: block;' if data.chart_type == 'donut' else 'display: none;' }}">
                <div class="donut-chart" id="donutChart" style="
                    width: 400px;
                    height: 400px;
                    border-radius: 50%;
                    background: conic-gradient(
                        {{ data.completed_color }} 0deg {{ data.completed_degrees }}deg,
                        {{ data.incomplete_color }} {{ data.completed_degrees }}deg 360deg
                    );
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    position: relative;
                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
                    margin: 0 auto;
                ">
                    <div class="donut-hole" style="
                        width: 220px;
                        height: 220px;
                        background: white;
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        position: absolute;
                    ">
                        <div class="donut-text" id="donutText" style="
                            font-size: {{ data.font_size }}px;
                            font-weight: 700;
                            color: {{ data.text_color }};
                            font-family: 'Inter', sans-serif;
                        ">
                            {{ "%.2f"|format(data.current) }}/{{ "%.2f"|format(data.max) }}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Battery Chart -->
            <div id="battery-container" class="chart-display"
                style="{{ 'display: block;' if data.chart_type == 'battery' else 'display: none;' }}">
                <div class="battery-chart" id="batteryChart" style="
                    width: 400px;
                    height: 100px;
                    border-radius: 12px;
                    background: linear-gradient(
                        to right,
                        {{ data.completed_color }} 0%,
                        {{ data.completed_color }} {{ data.percentage }}%,
                        {{ data.incomplete_color }} {{ data.percentage }}%,
                        {{ data.incomplete_color }} 100%
                    );
                    display: flex;
                    align-items: center;
                link.href = url;
                link.click();
                URL.revokeObjectURL(url);
            });
        }

        // Update color text inputs when color pickers change
        document.getElementById('completed_color').addEventListener('input', function (e) {
            this.nextElementSibling.value = e.target.value.toUpperCase();
        });

        document.getElementById('incomplete_color').addEventListener('input', function (e) {
            this.nextElementSibling.value = e.target.value.toUpperCase();
        });

        document.getElementById('text_color').addEventListener('input', function (e) {
            this.nextElementSibling.value = e.target.value.toUpperCase();
        });
    </script>
</body>

</html>